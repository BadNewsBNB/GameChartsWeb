# éƒ¨ç½²é—®é¢˜æ’æŸ¥æŒ‡å—

## é—®é¢˜ï¼šé¡µé¢è‡ªåŠ¨ä¸‹è½½è€Œä¸æ˜¯æ‰“å¼€

### ç—‡çŠ¶
- è®¿é—®ç½‘ç«™æ—¶æµè§ˆå™¨è‡ªåŠ¨ä¸‹è½½æ–‡ä»¶
- ä¸‹è½½çš„æ–‡ä»¶åç±»ä¼¼ `ä¸‹è½½.htm`ã€`index.html` ç­‰
- é¡µé¢æ— æ³•æ­£å¸¸æ˜¾ç¤º

### è§£å†³æ–¹æ¡ˆ

#### æ–¹æ¡ˆ1ï¼šä½¿ç”¨æ­£ç¡®çš„é™æ€ç½‘ç«™åœ°å€

##### è…¾è®¯äº‘ COS

1. **æ£€æŸ¥é™æ€ç½‘ç«™é…ç½®**
   - è¿›å…¥å­˜å‚¨æ¡¶
   - ç‚¹å‡»"åŸºç¡€é…ç½®" â†’ "é™æ€ç½‘ç«™"
   - ç¡®è®¤å·²å¼€å¯

2. **è·å–æ­£ç¡®çš„è®¿é—®åœ°å€**
   - åœ¨"é™æ€ç½‘ç«™"é…ç½®é¡µé¢
   - æ‰¾åˆ°"è®¿é—®èŠ‚ç‚¹"æˆ–"é™æ€ç½‘ç«™åŸŸå"
   - åœ°å€æ ¼å¼åº”è¯¥æ˜¯ï¼š
     ```
     http://bucket-name-appid.cos-website.ap-region.myqcloud.com
     ```
   - æ³¨æ„ï¼šåŒ…å« `cos-website` å…³é”®è¯

3. **é”™è¯¯ç¤ºä¾‹**ï¼ˆä¼šå¯¼è‡´ä¸‹è½½ï¼‰ï¼š
   ```
   âŒ https://bucket-name.cos.ap-beijing.myqcloud.com
   âŒ https://bucket-name.cos.ap-beijing.myqcloud.com/index.html
   ```

4. **æ­£ç¡®ç¤ºä¾‹**ï¼š
   ```
   âœ… http://bucket-name.cos-website.ap-beijing.myqcloud.com
   âœ… http://bucket-name.cos-website.ap-beijing.myqcloud.com/index.html
   ```

##### é˜¿é‡Œäº‘ OSS

1. **è·å–é™æ€ç½‘ç«™åŸŸå**
   - è¿›å…¥ Bucket
   - ç‚¹å‡»"ä¼ è¾“ç®¡ç†" â†’ "åŸŸåç®¡ç†"
   - æ‰¾åˆ°"Bucket åŸŸå"
   - æˆ–åœ¨"åŸºç¡€è®¾ç½®" â†’ "é™æ€é¡µé¢" ä¸­æŸ¥çœ‹

2. **æ­£ç¡®åœ°å€æ ¼å¼**ï¼š
   ```
   http://bucket-name.oss-cn-region.aliyuncs.com
   ```

3. **å¦‚æœè¿˜æ˜¯ä¸‹è½½**ï¼š
   - æ£€æŸ¥"é™æ€ç½‘ç«™æ‰˜ç®¡"æ˜¯å¦å·²å¼€å¯
   - å°è¯•ç»‘å®šè‡ªå®šä¹‰åŸŸå

#### æ–¹æ¡ˆ2ï¼šè®¾ç½®æ­£ç¡®çš„ Content-Type

å¦‚æœç¡®å®åœ¨ä½¿ç”¨é™æ€ç½‘ç«™åœ°å€ï¼Œä½†è¿˜æ˜¯ä¸‹è½½ï¼Œå¯èƒ½æ˜¯æ–‡ä»¶çš„ Content-Type ä¸æ­£ç¡®ã€‚

##### è…¾è®¯äº‘ COS

1. é€‰ä¸­ `index.html` æ–‡ä»¶
2. ç‚¹å‡»"è¯¦æƒ…"
3. æ‰¾åˆ°"è‡ªå®šä¹‰ Headers"
4. æ·»åŠ æˆ–ä¿®æ”¹ï¼š
   ```
   Content-Type: text/html; charset=utf-8
   ```

æˆ–è€…æ‰¹é‡è®¾ç½®ï¼ˆä½¿ç”¨ COSBrowserï¼‰ï¼š
- é€‰ä¸­æ‰€æœ‰ `.html` æ–‡ä»¶
- å³é”® â†’ "ä¿®æ”¹ HTTP å¤´éƒ¨"
- è®¾ç½® Content-Type ä¸º `text/html`

##### é˜¿é‡Œäº‘ OSS

1. é€‰ä¸­æ–‡ä»¶
2. ç‚¹å‡»"è®¾ç½® HTTP å¤´"
3. æ·»åŠ ï¼š
   ```
   Content-Type: text/html; charset=utf-8
   ```

#### æ–¹æ¡ˆ3ï¼šæ£€æŸ¥æµè§ˆå™¨è®¾ç½®

1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
2. ä½¿ç”¨æ— ç—•/éšç§æ¨¡å¼è®¿é—®
3. å°è¯•ä¸åŒçš„æµè§ˆå™¨

#### æ–¹æ¡ˆ4ï¼šé‡æ–°ä¸Šä¼ ï¼ˆæ¨èï¼‰

æœ‰æ—¶å€™ä¸Šä¼ æ—¶æ²¡æœ‰æ­£ç¡®è®¾ç½®ï¼Œé‡æ–°ä¸Šä¼ å¯ä»¥è§£å†³ï¼š

```bash
# 1. åˆ é™¤æ‰€æœ‰æ–‡ä»¶
# 2. é‡æ–°ä¸Šä¼  dist æ–‡ä»¶å¤¹çš„å†…å®¹
# 3. ç¡®ä¿ä¸Šä¼ æ—¶è‡ªåŠ¨è¯†åˆ«æ–‡ä»¶ç±»å‹
```

ä½¿ç”¨ COSBrowser æˆ– OSS Browser ä¸Šä¼ ä¼šè‡ªåŠ¨è®¾ç½®æ­£ç¡®çš„ Content-Typeã€‚

### éªŒè¯æ–¹æ³•

#### æ–¹æ³•1ï¼šä½¿ç”¨å¼€å‘è€…å·¥å…·

1. æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
2. åˆ‡æ¢åˆ° Network æ ‡ç­¾
3. è®¿é—®ç½‘ç«™
4. æŸ¥çœ‹ `index.html` çš„å“åº”å¤´
5. ç¡®è®¤ `Content-Type` æ˜¯ `text/html`

#### æ–¹æ³•2ï¼šä½¿ç”¨ curl å‘½ä»¤

```bash
curl -I http://your-static-website-url

# æŸ¥çœ‹å“åº”å¤´ä¸­çš„ Content-Type
# åº”è¯¥æ˜¯: Content-Type: text/html; charset=utf-8
```

### å®Œæ•´æ£€æŸ¥æ¸…å•

- [ ] å·²å¼€å¯é™æ€ç½‘ç«™æ‰˜ç®¡åŠŸèƒ½
- [ ] ä½¿ç”¨çš„æ˜¯é™æ€ç½‘ç«™ä¸“ç”¨åŸŸåï¼ˆåŒ…å« `cos-website` æˆ–ç±»ä¼¼æ ‡è¯†ï¼‰
- [ ] `index.html` çš„ Content-Type æ˜¯ `text/html`
- [ ] æ‰€æœ‰ HTML æ–‡ä»¶éƒ½åœ¨å­˜å‚¨æ¡¶æ ¹ç›®å½•ï¼ˆæˆ–æ­£ç¡®çš„å­ç›®å½•ï¼‰
- [ ] æµè§ˆå™¨ç¼“å­˜å·²æ¸…é™¤
- [ ] ä½¿ç”¨ HTTP åè®®è®¿é—®ï¼ˆä¸æ˜¯ HTTPSï¼Œé™¤éé…ç½®äº†è¯ä¹¦ï¼‰

## å…¶ä»–å¸¸è§é—®é¢˜

### é—®é¢˜ï¼šè®¿é—®æç¤º"NoSuchKey"æˆ–404

**åŸå› **ï¼šæ–‡ä»¶è·¯å¾„ä¸æ­£ç¡®

**è§£å†³**ï¼š
1. ç¡®è®¤ `index.html` åœ¨æ ¹ç›®å½•
2. ä¸è¦ä¸Šä¼  `dist` æ–‡ä»¶å¤¹ï¼Œè¦ä¸Šä¼ æ–‡ä»¶å¤¹**å†…**çš„æ–‡ä»¶
3. æ–‡ä»¶ç»“æ„åº”è¯¥æ˜¯ï¼š
   ```
   å­˜å‚¨æ¡¶æ ¹ç›®å½•/
   â”œâ”€â”€ index.html
   â”œâ”€â”€ assets/
   â”‚   â”œâ”€â”€ index-xxx.js
   â”‚   â””â”€â”€ index-xxx.css
   â””â”€â”€ favicon.ico
   ```

### é—®é¢˜ï¼šCSS/JS åŠ è½½å¤±è´¥

**åŸå› 1**ï¼šç›¸å¯¹è·¯å¾„é—®é¢˜

**è§£å†³**ï¼š
- æ£€æŸ¥ `vite.config.js` ä¸­çš„ `base` é…ç½®
- åº”è¯¥è®¾ç½®ä¸º `'/'` ï¼ˆæ ¹è·¯å¾„ï¼‰

```javascript
export default defineConfig({
  base: '/', // ç¡®ä¿æ˜¯æ ¹è·¯å¾„
  // ...
})
```

**åŸå› 2**ï¼šæ–‡ä»¶æ²¡æœ‰ä¸Šä¼ å®Œæ•´

**è§£å†³**ï¼š
- ç¡®è®¤ `assets` æ–‡ä»¶å¤¹ä¸­çš„æ‰€æœ‰æ–‡ä»¶éƒ½å·²ä¸Šä¼ 

### é—®é¢˜ï¼šAPI è°ƒç”¨å¤±è´¥

**åŸå› **ï¼šé™æ€æ‰˜ç®¡ä¸æ”¯æŒæœåŠ¡ç«¯ä»£ç†

**è§£å†³æ–¹æ¡ˆ**ï¼š

#### é€‰é¡¹1ï¼šä½¿ç”¨ Cloudflare Workersï¼ˆå…è´¹ï¼‰

åˆ›å»ºä¸€ä¸ª Worker æ¥ä»£ç† API è¯·æ±‚ï¼š

```javascript
addEventListener('fetch', event => {
  event.respondWith(handleRequest(event.request))
})

async function handleRequest(request) {
  const url = new URL(request.url)
  
  // å¦‚æœæ˜¯ /api å¼€å¤´çš„è¯·æ±‚ï¼Œè½¬å‘åˆ° Bangumi API
  if (url.pathname.startsWith('/api/')) {
    const apiUrl = 'https://api.bgm.tv' + url.pathname.replace('/api', '')
    const apiRequest = new Request(apiUrl, {
      method: request.method,
      headers: request.headers,
      body: request.body
    })
    
    const response = await fetch(apiRequest)
    const newResponse = new Response(response.body, response)
    
    // æ·»åŠ  CORS å¤´
    newResponse.headers.set('Access-Control-Allow-Origin', '*')
    newResponse.headers.set('Access-Control-Allow-Methods', 'GET, POST, PUT, DELETE, OPTIONS')
    newResponse.headers.set('Access-Control-Allow-Headers', 'Content-Type, Authorization')
    
    return newResponse
  }
  
  return fetch(request)
}
```

ç„¶ååœ¨å‰ç«¯ä¿®æ”¹ API åŸºç¡€åœ°å€ä¸º Worker çš„åœ°å€ã€‚

#### é€‰é¡¹2ï¼šä½¿ç”¨äº‘å‡½æ•°

è…¾è®¯äº‘å’Œé˜¿é‡Œäº‘éƒ½æœ‰äº‘å‡½æ•°æœåŠ¡ï¼ˆæœ‰å…è´¹é¢åº¦ï¼‰ï¼Œå¯ä»¥åˆ›å»ºå‡½æ•°æ¥è½¬å‘ API è¯·æ±‚ã€‚

#### é€‰é¡¹3ï¼šä¿®æ”¹å‰ç«¯ä»£ç ç›´æ¥è°ƒç”¨

å¦‚æœ Bangumi API æ”¯æŒ CORSï¼Œå¯ä»¥ç›´æ¥è°ƒç”¨ï¼š

```javascript
// src/api/bangumi.js
const instance = axios.create({
  baseURL: 'https://api.bgm.tv', // ç›´æ¥ä½¿ç”¨ API åœ°å€
  // ...
})
```

ä½†è¿™æ ·ä¼šå—åˆ° CORS é™åˆ¶ã€‚

### é—®é¢˜ï¼šè®¿é—®å¾ˆæ…¢

**è§£å†³**ï¼šé…ç½® CDN åŠ é€Ÿ

1. è…¾è®¯äº‘ï¼šåœ¨å­˜å‚¨æ¡¶ä¸­é…ç½®"CDN åŠ é€ŸåŸŸå"
2. é˜¿é‡Œäº‘ï¼šå¼€é€š CDN æœåŠ¡ï¼Œæºç«™æŒ‡å‘ OSS
3. éœ€è¦è‡ªå®šä¹‰åŸŸåï¼ˆä¸”å·²å¤‡æ¡ˆï¼‰

### é—®é¢˜ï¼šHTTPS è®¿é—®å¤±è´¥

**åŸå› **ï¼šé™æ€ç½‘ç«™é»˜è®¤åªæ”¯æŒ HTTP

**è§£å†³**ï¼š
1. ç»‘å®šè‡ªå®šä¹‰åŸŸå
2. ä¸Šä¼  SSL è¯ä¹¦ï¼ˆå¯ä»¥åœ¨äº‘æœåŠ¡å•†å…è´¹ç”³è¯·ï¼‰
3. é…ç½® HTTPS è®¿é—®

æˆ–è€…ä½¿ç”¨ Cloudflare æä¾›å…è´¹çš„ SSLã€‚

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœä»¥ä¸Šæ–¹æ¡ˆéƒ½æ— æ³•è§£å†³é—®é¢˜ï¼š

1. æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
   - ä½¿ç”¨çš„äº‘æœåŠ¡å•†ï¼ˆè…¾è®¯äº‘/é˜¿é‡Œäº‘ï¼‰
   - è®¿é—®çš„ URL
   - æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯
   - Network æ ‡ç­¾ä¸­çš„è¯·æ±‚è¯¦æƒ…

2. æˆªå›¾ï¼š
   - é™æ€ç½‘ç«™é…ç½®é¡µé¢
   - æµè§ˆå™¨æ§åˆ¶å°
   - å­˜å‚¨æ¡¶æ–‡ä»¶åˆ—è¡¨

æˆ‘ä¼šå¸®ä½ å…·ä½“åˆ†æï¼

